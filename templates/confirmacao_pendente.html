<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Confirme seu e-mail</title>
    <link rel="stylesheet" href="css/register-full.css">
</head>
<body class="hero-page">
    <div class="form-wrapper">
        <div class="form-box" style="text-align: center;">
            <h2>Quase lÃ¡! ðŸ“§</h2>
            <p>Enviamos um link de ativaÃ§Ã£o para o seu e-mail.</p>
            <p>Por favor, verifique sua caixa de entrada (e o spam) para ativar sua conta.</p>
            <br>
        </div>
    </div>

<script>
    // 1. Pega o e-mail da URL
    const urlParams = new URLSearchParams(window.location.search);
    const email = urlParams.get('email');

    if (email) {
        // 2. FunÃ§Ã£o que checa no servidor
        const checarStatus = async () => {
            try {
                const res = await fetch(`/api/checar-ativacao/?email=${email}`);
                const data = await res.json();

                if (data.ativo === true) {
                    // 3. Se ativou, manda para o perfil!
                    window.location.href = '{% url "perfil" %}';
                }
            } catch (err) {
                console.error("Erro ao checar status");
            }
        };

        // Executa a checagem a cada 3 segundos
        const intervalo = setInterval(checarStatus, 3000);
    }
</script>

</body>
</html>